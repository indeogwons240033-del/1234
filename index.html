<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>정규분포 Z 확률 계산기</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body {
    font-family: sans-serif;
    margin: 20px;
    background: #f9fafb;
  }
  h1 {
    text-align: center;
  }
  .controls {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-bottom: 20px;
  }
  canvas {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }
  #result {
    text-align: center;
    font-size: 1.2rem;
    margin-top: 10px;
  }
</style>
</head>
<body>
<h1>정규분포 Z 확률 계산기</h1>
<div class="controls">
  <label>Z 최소: <input type="number" id="zMin" step="0.1" value="-1"></label>
  <label>Z 최대: <input type="number" id="zMax" step="0.1" value="1"></label>
  <button onclick="calculateArea()">계산</button>
</div>
<canvas id="chart" width="600" height="400"></canvas>
<p id="result"></p>

<script>
function normalPDF(x) {
  return Math.exp(-0.5 * x * x) / Math.sqrt(2 * Math.PI);
}

function simpsonsRule(f, a, b, n = 1000) {
  if (n % 2 !== 0) n++;
  const h = (b - a) / n;
  let sum = f(a) + f(b);
  for (let i = 1; i < n; i++) {
    const x = a + i * h;
    sum += f(x) * (i % 2 === 0 ? 2 : 4);
  }
  return (h / 3) * sum;
}

function calculateArea() {
  const zMin = parseFloat(document.getElementById('zMin').value);
  const zMax = parseFloat(document.getElementById('zMax').value);
  const area = simpsonsRule(normalPDF, zMin, zMax);
  document.getElementById('result').textContent = `P(${zMin} < Z < ${zMax}) ≈ ${area.toFixed(4)}`;
  drawChart(zMin, zMax);
}

let chart;
function drawChart(zMin, zMax) {
  const xs = [], ys = [];
  const step = 0.05;
  for (let x = -4; x <= 4; x += step) {
    xs.push(x);
    ys.push(normalPDF(x));
  }
  const bgColors = ys.map((y, i) => (xs[i] >= zMin && xs[i] <= zMax ? 'rgba(54, 162, 235, 0.4)' : 'rgba(200,200,200,0.2)'));

  const ctx = document.getElementById('chart').getContext('2d');
  if (chart) chart.destroy();
  chart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: xs,
      datasets: [{
        label: '정규분포 (μ=0, σ=1)',
        data: ys,
        backgroundColor: bgColors,
        borderColor: 'blue',
        borderWidth: 1
      }]
    },
    options: {
      scales: {
        x: { title: { display: true, text: 'Z 값' } },
        y: { title: { display: true, text: '확률밀도' } }
      },
      plugins: { legend: { display: false } }
    }
  });
}

drawChart(-1, 1);
calculateArea();
</script>
</body>
</html>
